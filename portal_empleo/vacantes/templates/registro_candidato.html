{% extends 'base.html' %}

{% load static %}
{% block titulo %}
Inicio
{% endblock %}

{% block contenido %}
<link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/css/select2.min.css" rel="stylesheet" />
<style>
    h1.text-center {
        font-size: 2rem !important; /* Ajusta el tama√±o */
        font-weight: bold !important;
        color:rgb(94, 78, 28) !important; /* Color dorado */
        text-transform: uppercase !important;
        line-height: 1.2;
        margin-bottom: 1.5rem;
    }
    
    .authorization-modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.8);
        z-index: 2001;
        animation: fadeIn 0.3s ease-in-out;
    }

    .authorization-content {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: linear-gradient(145deg, #1a1a1a, #2d2d2d);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 12px;
        width: 90%;
        max-width: 600px;
        color: white;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
    }

    .authorization-header {
        padding: 20px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        background: rgba(0, 0, 0, 0.2);
        border-radius: 12px 12px 0 0;
    }

    .authorization-header h4 {
        margin: 0;
        color: #f8d047;
        font-size: 1.5rem;
    }

    .authorization-body {
        padding: 25px;
        font-size: 1.1em;
        line-height: 1.6;
        max-height: 60vh;
        overflow-y: auto;
    }

    .authorization-footer {
        padding: 20px;
        border-top: 1px solid rgba(255, 255, 255, 0.1);
        display: flex;
        justify-content: flex-end;
        gap: 15px;
        background: rgba(0, 0, 0, 0.2);
        border-radius: 0 0 12px 12px;
    }

    .auth-button {
        padding: 12px 25px;
        border-radius: 8px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 1px;
        transition: all 0.3s ease;
        cursor: pointer;
        border: none;
    }

    .auth-accept {
        background: linear-gradient(145deg, #f8d047, #f8b947);
        color: black;
    }

    .auth-decline {
        background: transparent;
        color: #ffffff;
        border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .auth-button:hover {
        transform: translateY(-2px);
    }

    .auth-accept:hover {
        box-shadow: 0 5px 15px rgba(248, 208, 71, 0.3);
    }

    .auth-decline:hover {
        background: rgba(255, 255, 255, 0.1);
    }

    @keyframes fadeIn {
        from { opacity: 0; transform: translate(-50%, -48%); }
        to { opacity: 1; transform: translate(-50%, -50%); }
    }

    .tutorial-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.8);
    z-index: 2000;
    animation: fadeIn 0.3s ease-in-out;
    }

    .tutorial-content {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: linear-gradient(145deg, #1a1a1a, #2d2d2d);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 12px;
        width: 90%;
        max-width: 700px;
        color: white;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        max-height: 90vh;
        overflow-y: auto;
    }

    .tutorial-header {
        padding: 20px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: rgba(0, 0, 0, 0.2);
    }

    .tutorial-header h4 {
        margin: 0;
        color: #f8d047;
    }

    .tutorial-body {
        padding: 20px;
    }

    .tutorial-step {
        display: flex;
        align-items: flex-start;
        margin-bottom: 20px;
        background: rgba(255, 255, 255, 0.05);
        padding: 15px;
        border-radius: 8px;
        transition: transform 0.2s;
    }

    .tutorial-step:hover {
        transform: translateX(5px);
        background: rgba(255, 255, 255, 0.08);
    }

    .step-number {
        background: #f8d047;
        color: black;
        width: 28px;
        height: 28px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        margin-right: 15px;
        flex-shrink: 0;
    }

    .step-content {
        flex: 1;
    }

    .step-content h6 {
        color: #f8d047;
        margin-bottom: 8px;
    }

    .step-content ul {
        margin: 5px 0;
        padding-left: 20px;
    }

    .example-box {
        background: rgba(248, 208, 71, 0.1);
        border-left: 3px solid #f8d047;
        padding: 8px 12px;
        margin-top: 5px;
        border-radius: 0 4px 4px 0;
        font-size: 0.9em;
    }

    .tutorial-footer {
        padding: 20px;
        border-top: 1px solid rgba(255, 255, 255, 0.1);
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: rgba(0, 0, 0, 0.2);
    }

    .tutorial-button {
        background: #f8d047;
        color: black;
        border: none;
        padding: 8px 20px;
        border-radius: 6px;
        cursor: pointer;
        font-weight: bold;
        transition: all 0.3s ease;
    }

    .tutorial-button:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(248, 208, 71, 0.3);
    }

    .no-show-again {
        display: flex;
        align-items: center;
        gap: 8px;
        color: #adb5bd;
    }

    .tutorial-close {
        background: none;
        border: none;
        color: white;
        font-size: 24px;
        cursor: pointer;
        padding: 0 8px;
    }

    .tutorial-close:hover {
        color: #f8d047;
    }

    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }

    /* Estilos generales del formulario */
    .card {
        border-radius: 15px;
        background: linear-gradient(145deg, #1a1a1a, #2d2d2d) !important;
    }
    
    .form-control {
        background-color: #2d2d2d !important;
        border: 1px solid #404040 !important;
        color: #ffffff !important;
        border-radius: 8px;
    }

    .form-control:focus {
        box-shadow: 0 0 0 0.2rem rgba(0,123,255,0.25);
        background-color: #333333 !important;
    }

    /* Estilos para Select2 */
    .select2-container--default .select2-selection--multiple {
        background-color: #2d2d2d !important;
        border: 1px solid #404040 !important;
        border-radius: 8px;
    }

    .select2-container--default .select2-selection--multiple .select2-selection__choice {
        background-color:#f8d047 !important;
        color: white !important;
        border: none !important;
        border-radius: 15px !important;
        padding: 2px 8px !important;
    }

    .select2-container--default .select2-results__option--highlighted[aria-selected] {
        background-color: #f8d047 !important;
        color: white !important;
    }

    .select2-container--default .select2-results__option[aria-selected=true] {
        background-color: #f8d047 !important;
        color: white !important;
    }

    .select2-dropdown {
        background-color: #2d2d2d !important;
        border: 1px solid #404040 !important;
    }

    .select2-search__field {
        background-color: #333333 !important;
        color: white !important;
    }

    .select2-results__option {
        color: #ffffff !important;
    }

    /* Estilos para labels */
    label {
        font-weight: 500;
        margin-bottom: 0.5rem;
        color: #e0e0e0 !important;
    }

    /* Estilos para el bot√≥n */
    .btn-primary {
        background: linear-gradient(145deg, #f8d047, #f8d047) !important;
        border: none;
        padding: 12px 25px;
        border-radius: 8px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 1px;
        transition: all 0.3s ease;
    }

    .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px #f8d047;
    }

    /* Estilos para los grupos de form-row */
    .form-row {
        margin-bottom: 1.5rem;
    }

    /* Animaci√≥n al cargar el formulario */
    .card {
        animation: fadeIn 0.5s ease-in-out;
    }

    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }
</style>
{% if not user.is_authenticated %}
<div class="tutorial-modal" id="tutorialModal">
    <div class="tutorial-content">
        <div class="tutorial-header">
            <h4>üìù Gu√≠a de Registro de Hoja de Vida</h4>
            <button class="tutorial-close" onclick="closeTutorial()">√ó</button>
        </div>
        <div class="tutorial-body">
            <div class="tutorial-step">
                <span class="step-number">1</span>
                <div class="step-content">
                    <h6>Datos Personales</h6>
                    <p>Diligencia tus datos personales:</p>
                    <ul>
                        <li>Sexo</li>
                        <li>Tipo de Documento</li>
                        <li>N√∫mero de Documento</li>
                        <li>Nombres y Apellidos</li>
                        <li>N√∫mero de Celular</li>
                        <li>Dem√°s informaci√≥n personal</li>
                    </ul>
                </div>
            </div>
            
            <div class="tutorial-step">
                <span class="step-number">2</span>
                <div class="step-content">
                    <h6>Formaci√≥n Acad√©mica</h6>
                    <p>Registra tu nivel de formaci√≥n acad√©mica y el programa acad√©mico m√°s relevante que hayas alcanzado.</p>
                </div>
            </div>
            
            <div class="tutorial-step">
                <span class="step-number">3</span>
                <div class="step-content">
                    <h6>Experiencia Laboral</h6>
                    <p>Registra tus √∫ltimas 3 experiencias laborales con el siguiente formato:</p>
                    <div class="example-box">
                        √öltimo cargo - Fecha inicio a Fecha fin - Empresa
                    </div>
                </div>
            </div>
            
            <div class="tutorial-step">
                <span class="step-number">4</span>
                <div class="step-content">
                    <h6>Inter√©s Ocupacional</h6>
                    <p>Registra los tipos de cargos que te interesan para futuras oportunidades, por ejemplo:</p>
                    <div class="example-box">
                        Auxiliar de bodega, Call center, Operario de producci√≥n
                    </div>
                </div>
            </div>
            
            <div class="tutorial-step">
                <span class="step-number">5</span>
                <div class="step-content">
                    <h6>Perfil Laboral</h6>
                    <p>Completa los datos adicionales de tu perfil:</p>
                    <ul>
                        <li>Localidad/Municipio</li>
                        <li>Horario de Inter√©s</li>
                        <li>Aspiraci√≥n Salarial</li>
                        <li>Dem√°s informaci√≥n requerida</li>
                    </ul>
                </div>
            </div>
            
            <div class="tutorial-step">
                <span class="step-number">6</span>
                <div class="step-content">
                    <h6>Confirmar Vacantes</h6>
                    <p>Selecciona las vacantes a las que deseas aplicar en "Vacantes disponibles" y presiona el bot√≥n registrar.</p>
                </div>
            </div>
        </div>
        <div class="tutorial-footer">
            <label class="no-show-again">
                <input type="checkbox" id="noShowAgain"> No mostrar de nuevo
            </label>
            <button class="tutorial-button" onclick="closeTutorial()">¬°Comenzar Registro!</button>
        </div>
    </div>
</div>
{% endif %}
<div class="authorization-modal" id="authorizationModal">
    <div class="authorization-content">
        <div class="authorization-header">
            <h4>üîí Autorizaci√≥n de Tratamiento de Datos</h4>
        </div>
        <div class="authorization-body">
            <p>De conformidad con la Ley Estatutaria 1581 de 2012 de Protecci√≥n de Datos y normas concordantes, autorizo como titular de los datos personales para que sean tratados de acuerdo a la pol√≠tica de protecci√≥n de datos personales que incluye:</p>
            
            <ul style="margin-top: 15px; margin-bottom: 15px;">
                <li>Recolecci√≥n de informaci√≥n personal</li>
                <li>Almacenamiento seguro de los datos</li>
                <li>Uso de la informaci√≥n para procesos de selecci√≥n</li>
                <li>Transferencia a terceros cuando sea necesario</li>
                <li>Comunicaci√≥n de oportunidades laborales</li>
            </ul>

            <p>Entiendo que puedo ejercer mis derechos de conocer, actualizar, rectificar y suprimir mi informaci√≥n personal, as√≠ como el derecho a revocar el consentimiento otorgado para el tratamiento de datos personales.</p>
        </div>
        <div class="authorization-footer">
            <button class="auth-button auth-decline" onclick="declineAuthorization()">No Autorizo</button>
            <button class="auth-button auth-accept" onclick="acceptAuthorization()">Autorizo</button>
        </div>
    </div>
</div>


<div class="container mt-5" style="text-align: center;">
    
    <h1 class="text-center">Formulario de Registro de Candidato</h1>
    
    <div class="card shadow-sm p-4 text-light bg-dark"  style="background-color: rgb(248, 248, 248);">
        
        {% if form.errors %}
        <div class="alert alert-danger">
            <ul>
                {% for field in form %}
                    {% for error in field.errors %}
                        <li>{{ error }}</li>
                    {% endfor %}
                {% endfor %}
            </ul>
        </div>
        {% endif %}

        <form method="post">
            {% csrf_token %}

            {% if request.user.is_authenticated %}
            <div class="form-row">
                <div class="form-group col-md-6">
                    <label for="feria">Feria</label>
                    {{ form.feria }}
                </div>
                <div class="form-group col-md-6">
                    <label for="fecha_feria">Fecha de Feria</label>
                    <input type="date" name="fecha_feria" id="fecha_feria" 
                           class="form-control" 
                           value="{{ form.fecha_feria.value|date:'Y-m-d' }}"
                           {% if form.fecha_feria.field.required %}required{% endif %}>
                </div>
            </div>
            {% endif %}   

            <div class="form-row">
                <div class="form-group col-md-6">
                    <label for="sexo">Sexo</label>
                    {{ form.sexo }}
                </div>
                <div class="form-group col-md-6">
                    <label for="tipo_documento">Tipo de Documento</label>
                    {{ form.tipo_documento }}
                </div>
            </div>

            <div class="form-row">
                <div class="form-group col-md-6">
                    <label for="numero_documento">N√∫mero de Documento</label>
                    {{ form.numero_documento }}
                </div>
                <div class="form-group col-md-6">
                    <label for="nombres">Nombres</label>
                    {{ form.nombres }}
                </div>
            </div>

            <div class="form-row">
                <div class="form-group col-md-6">
                    <label for="apellidos">Apellidos</label>
                    {{ form.apellidos }}
                </div>
                <div class="form-group col-md-6">
                    <label for="numero_celular">N√∫mero de Celular</label>
                    {{ form.numero_celular }}
                </div>
            </div>

            <div class="form-row">
                <div class="form-group col-md-6">
                    <label for="correo_electronico">Correo Electr√≥nico</label>
                    {{ form.correo_electronico }}
                </div>
                <div class="form-group col-md-6">
                    <label for="fecha_nacimiento">Fecha de Nacimiento</label>
                    <input type="date" name="fecha_nacimiento" id="fecha_nacimiento" 
                           class="form-control" 
                           value="{{ form.fecha_nacimiento.value|date:'Y-m-d' }}"
                           {% if form.fecha_nacimiento.field.required %}required{% endif %}>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group col-md-6">
                    <label for="formacion_academica">Formaci√≥n Acad√©mica</label>
                    {{ form.formacion_academica }}
                </div>
                <div class="form-group col-md-6">
                    <label for="programa_academico">Programa Acad√©mico</label>
                    {{ form.programa_academico }}
                </div>
            </div>

            <div class="form-row">
                <div class="form-group col-md-6">
                    <label for="experiencia_laboral">Experiencia Laboral</label>
                    {{ form.experiencia_laboral }}
                </div>
                <div class="form-group col-md-6">
                    <label for="interes_ocupacional">Inter√©s Ocupacional</label>
                    {{ form.interes_ocupacional }}
                </div>
            </div>
            
            <div class="form-row">
                <div class="form-group col-md-6">
                    <label for="{{ form.departamento.id_for_label }}">Departamento</label>
                    {{ form.departamento }}
                </div>
                <div class="form-group col-md-6">
                    <label for="{{ form.ciudad.id_for_label }}">Ciudad o Municipio</label>
                    {{ form.ciudad }}
                </div>
            </div>
            

            <div class="form-row">
                <div class="form-group col-md-6">
                    <label for="horario_interesado">Horario de Inter√©s</label>
                    {{ form.horario_interesado }}
                </div>
            </div>

            <div class="form-row">
                <div class="form-group col-md-6">
                    <label for="aspiracion_salarial">Aspiraci√≥n Salarial</label>
                    {{ form.aspiracion_salarial }}
                </div>
                <div class="form-group col-md-6">
                    <label for="registrado_en_sise">¬øEst√° registrado en SISE?</label>
                    {{ form.registrado_en_sise }}
                </div>
                
            </div>

            <div class="form-row">
                {% if request.user.is_authenticated %}
                <div class="form-group col-md-6">
                    <label for="tecnico_seleccion">T√©cnico de Selecci√≥n</label>
                    {{ form.tecnico_seleccion }}
                </div>
                {% endif %}
                <div class="form-group col-md-6">
                    <label for="vacantes">Vacantes disponibles</label>
                    <select id="vacantes" name="vacantes_disponibles" class="form-control" multiple="multiple" >
                        {% for vacante in form.fields.vacantes_disponibles.queryset %}
                            <option value="{{ vacante.id }}" 
                                {% if vacante in selected_vacantes %}selected{% endif %}>
                                {{ vacante }}
                            </option>
                        {% endfor %}
                    </select>
                </div>   
            </div>

            <div class="form-row">
                <div class="form-group col-md-6">
                    <label for="candidato_discapacidad">¬øEs candidato con discapacidad?</label>
                    {{ form.candidato_discapacidad }}
                </div>

                <div class="form-group col-md-6" id="tipo_discapacidad_container" style="display: none;">
                    <label for="tipo_discapacidad">Tipo de Discapacidad</label>
                    {{ form.tipo_discapacidad }}
                </div>
            </div>

            <button type="submit" class="btn btn-primary btn-block mt-3">
                {% if is_edit %}Actualizar{% else %}Registrar{% endif %}
            </button>
        </form>
    </div>
</div>

<link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/css/select2.min.css" rel="stylesheet" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.13/js/select2.min.js"></script>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Validaci√≥n en tiempo real para N√∫mero de Celular
        const celularInput = document.getElementById('numero_celular');
        if (celularInput) {
            celularInput.addEventListener('input', function(e) {
                // Remover caracteres no num√©ricos
                this.value = this.value.replace(/\D/g, '');
                
                // Limitar a un m√°ximo de 10 cifras
                if (this.value.length > 10) {
                    this.value = this.value.slice(0, 10);
                }
            });
        }
    
        // Formateo de Millares para Aspiraci√≥n Salarial
        const salarioInput = document.getElementById('aspiracion_salarial');
        if (salarioInput) {
            salarioInput.addEventListener('input', function(e) {
                // Remover comas existentes para no duplicarlas
                let valorSinComas = this.value.replace(/,/g, '');
                
                // Remover espacios en blanco
                valorSinComas = valorSinComas.replace(/\s+/g, '');
    
                // Verificar si es un n√∫mero v√°lido
                if (!isNaN(valorSinComas) && valorSinComas !== '') {
                    // Formatear el n√∫mero con separadores de miles
                    this.value = parseInt(valorSinComas).toLocaleString('en-US');
                } else {
                    // Si no es n√∫mero, limpiar el campo
                    this.value = '';
                }
            });
        }
    });
    
    document.addEventListener('DOMContentLoaded', function() {
        // Formateo de Millares para Aspiraci√≥n Salarial
        const salarioInput = document.getElementById('aspiracion_salarial');
        if (salarioInput) {
            salarioInput.addEventListener('input', function(e) {
                // Remover comas existentes para no duplicarlas
                let valorSinComas = this.value.replace(/,/g, '');
                
                // Remover espacios en blanco
                valorSinComas = valorSinComas.replace(/\s+/g, '');
    
                // Verificar si es un n√∫mero v√°lido
                if (!isNaN(valorSinComas) && valorSinComas !== '') {
                    // Formatear el n√∫mero con separadores de miles
                    this.value = parseInt(valorSinComas).toLocaleString('en-US');
                } else {
                    // Si no es n√∫mero, limpiar el campo
                    this.value = '';
                }
            });
        }
    });
    
    document.addEventListener('DOMContentLoaded', function() {
        // Validaci√≥n y formateo de Fecha de Nacimiento
        const fechaNacimientoInput = document.getElementById('fecha_nacimiento');
        if (fechaNacimientoInput) {
            const today = new Date();
            const minDate = new Date(today.getFullYear() - 15, today.getMonth(), today.getDate());
            const minDateFormatted = minDate.toISOString().split('T')[0];
            
            // Establecer el atributo max en el campo de fecha
            fechaNacimientoInput.setAttribute('max', minDateFormatted);
    
            // Agregar evento para validar cuando se cambia la fecha
            fechaNacimientoInput.addEventListener('change', function() {
                const selectedDate = new Date(this.value);
                
                // Verificar si la fecha seleccionada es mayor a la fecha m√≠nima permitida
                if (selectedDate > minDate) {
                    alert("Para registrarte debes ser mayor de edad o m√≠nimo tener 15 a√±os con previo permiso de tus padres.");
                    this.value = ''; // Limpia el campo de fecha
                }
            });
        }
    
        // Formateo de Millares para Aspiraci√≥n Salarial
        const salarioInput = document.getElementById('aspiracion_salarial');
        if (salarioInput) {
            salarioInput.addEventListener('input', function(e) {
                // Remover comas existentes para no duplicarlas
                let valorSinComas = this.value.replace(/,/g, '');
                
                // Remover espacios en blanco
                valorSinComas = valorSinComas.replace(/\s+/g, '');
    
                // Verificar si es un n√∫mero v√°lido
                if (!isNaN(valorSinComas) && valorSinComas !== '') {
                    // Formatear el n√∫mero con separadores de miles
                    this.value = parseInt(valorSinComas).toLocaleString('en-US');
                } else {
                    // Si no es n√∫mero, limpiar el campo
                    this.value = '';
                }
            });
        }
    });
    
    document.addEventListener('DOMContentLoaded', function() {
        const fechaNacimientoInput = document.getElementById('fecha_nacimiento');
        
        if (fechaNacimientoInput) {
            const today = new Date();
            const minDate = new Date(today.getFullYear() - 15, today.getMonth(), today.getDate());
            const minDateFormatted = minDate.toISOString().split('T')[0];
            
            // Establecer el atributo max en el campo de fecha
            fechaNacimientoInput.setAttribute('max', minDateFormatted);
    
            // Agregar evento para validar cuando se cambia la fecha
            fechaNacimientoInput.addEventListener('change', function() {
                const selectedDate = new Date(this.value);
                
                // Verificar si la fecha seleccionada es mayor a la fecha m√≠nima permitida
                if (selectedDate > minDate) {
                    alert("Para registrarte debes ser mayor de edad o m√≠nimo tener 15 a√±os con previo permiso de tus padres.");
                    this.value = ''; // Limpia el campo de fecha
                }
            });
        }
    });
    
    document.addEventListener('DOMContentLoaded', function() {
        // Inicializar Select2 en el campo de vacantes
        $('#vacantes').select2({
            placeholder: "Seleccione vacantes",
            allowClear: true
        });

        // Si estamos en modo edici√≥n, no necesitamos cargar desde URL
        {% if not is_edit %}
            const urlParams = new URLSearchParams(window.location.search);
            const selectedVacantes = urlParams.get('selected_vacantes') ? urlParams.get('selected_vacantes').split(',') : [];
            $('#vacantes').val(selectedVacantes).trigger('change');
        {% endif %}
        });
        function showTutorial() {
        const noShow = localStorage.getItem('noShowRegistrationTutorial');
        if (!noShow) {
            document.getElementById('tutorialModal').style.display = 'block';
        }
    }

    function closeTutorial() {
        document.getElementById('tutorialModal').style.display = 'none';
        if (document.getElementById('noShowAgain').checked) {
            localStorage.setItem('noShowRegistrationTutorial', 'true');
        }
    }

    // A√±ade esto al final del DOMContentLoaded existente
    document.addEventListener('DOMContentLoaded', function() {
        // ... c√≥digo existente ...
        
        // Mostrar el tutorial
        showTutorial();
    });

</script>


{% comment %} script para mostrar el campo tipo_discapacidad cuando se selecciona la opci√≥n SI en candidato_discapacidad {% endcomment %}

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Validaci√≥n en tiempo real para N√∫mero de Celular
        const celularInput = document.getElementById('numero_celular');
        if (celularInput) {
            celularInput.addEventListener('input', function(e) {
                // Remover caracteres no num√©ricos
                this.value = this.value.replace(/\D/g, '');
                
                // Limitar a un m√°ximo de 10 cifras
                if (this.value.length > 10) {
                    this.value = this.value.slice(0, 10);
                }
            });
        }
    
        // Validaci√≥n en tiempo real para N√∫mero de Documento
        const documentoInput = document.getElementById('numero_documento');
        if (documentoInput) {
            documentoInput.addEventListener('input', function(e) {
                // Remover caracteres no num√©ricos y espacios
                this.value = this.value.replace(/\D/g, '');
            });
        }
    
        // Formateo de Millares para Aspiraci√≥n Salarial
        const salarioInput = document.getElementById('aspiracion_salarial');
        if (salarioInput) {
            salarioInput.addEventListener('input', function(e) {
                // Remover comas existentes para no duplicarlas
                let valorSinComas = this.value.replace(/,/g, '');
                
                // Remover espacios en blanco
                valorSinComas = valorSinComas.replace(/\s+/g, '');
    
                // Verificar si es un n√∫mero v√°lido
                if (!isNaN(valorSinComas) && valorSinComas !== '') {
                    // Formatear el n√∫mero con separadores de miles
                    this.value = parseInt(valorSinComas).toLocaleString('en-US');
                } else {
                    // Si no es n√∫mero, limpiar el campo
                    this.value = '';
                }
            });
        }
    });
    
    document.addEventListener('DOMContentLoaded', function() {
        const discapacidadField = document.querySelector('[name="candidato_discapacidad"]');
        const tipoDiscapacidadContainer = document.getElementById('tipo_discapacidad_container');
    
        function toggleTipoDiscapacidad() {
            if (discapacidadField.value === 'SI') {
                tipoDiscapacidadContainer.style.display = 'block';
            } else {
                tipoDiscapacidadContainer.style.display = 'none';
            }
        }
    
        discapacidadField.addEventListener('change', toggleTipoDiscapacidad);
    
        // Inicializar el estado del campo al cargar la p√°gina
        toggleTipoDiscapacidad();
    });
    // Funci√≥n para mostrar el tutorial
function showTutorial() {
    const noShow = localStorage.getItem('noShowRegistrationTutorial');
    if (!noShow) {
        document.getElementById('tutorialModal').style.display = 'block';
    } else {
        // Si el usuario eligi√≥ no mostrar el tutorial, mostrar directamente el modal de autorizaci√≥n
        document.getElementById('authorizationModal').style.display = 'block';
    }
}

// Funci√≥n para cerrar el tutorial y mostrar la autorizaci√≥n
function closeTutorial() {
    document.getElementById('tutorialModal').style.display = 'none';
    if (document.getElementById('noShowAgain').checked) {
        localStorage.setItem('noShowRegistrationTutorial', 'true');
    }
    // Mostrar el modal de autorizaci√≥n despu√©s de cerrar el tutorial
    document.getElementById('authorizationModal').style.display = 'block';
}

// Funciones para manejar la autorizaci√≥n
function acceptAuthorization() {
    document.getElementById('authorizationModal').style.display = 'none';
    // Continuar con el formulario
}

function declineAuthorization() {
    // Redirigir a la p√°gina de inicio
    window.location.href = '/';
}

// Inicializaci√≥n cuando el DOM est√° listo
document.addEventListener('DOMContentLoaded', function() {
    // Inicializar Select2 en el campo de vacantes
    $('#vacantes').select2({
        placeholder: "Seleccione vacantes",
        allowClear: true
    });

    // Cargar vacantes seleccionadas si no estamos en modo edici√≥n
    {% if not is_edit %}
        const urlParams = new URLSearchParams(window.location.search);
        const selectedVacantes = urlParams.get('selected_vacantes') ? urlParams.get('selected_vacantes').split(',') : [];
        $('#vacantes').val(selectedVacantes).trigger('change');
    {% endif %}

    // Inicializar el manejo de discapacidad
    const discapacidadField = document.querySelector('[name="candidato_discapacidad"]');
    const tipoDiscapacidadContainer = document.getElementById('tipo_discapacidad_container');
    
    function toggleTipoDiscapacidad() {
        if (discapacidadField.value === 'SI') {
            tipoDiscapacidadContainer.style.display = 'block';
        } else {
            tipoDiscapacidadContainer.style.display = 'none';
        }
    }
    
    discapacidadField.addEventListener('change', toggleTipoDiscapacidad);
    toggleTipoDiscapacidad();

    // Mostrar el tutorial o el modal de autorizaci√≥n
    showTutorial();
});
    </script>

    <script>
        //filtrar ciudades por departamento
        $(document).ready(function () {
            $("#departamento-select").change(function () {
                var departamentoId = $(this).val();
                var ciudadSelect = $("#ciudad-select");
    
                ciudadSelect.empty().append('<option value="">Seleccione una ciudad</option>');
    
                if (departamentoId) {
                    $.ajax({
                        url: "{% url 'cargar_ciudades' %}",
                        data: { departamento_id: departamentoId },
                        success: function (data) {
                            $.each(data, function (key, value) {
                                ciudadSelect.append('<option value="' + value.id + '">' + value.nombre + '</option>');
                            });
                        }
                    });
                }
            });
        });
    </script>



{% endblock %}